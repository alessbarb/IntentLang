{"source_il":"uses { random: Random { } }\n\nfunc add(a: Int, b: Int): Int\n  requires a >= 0 && b >= 0\n  ensures _ >= a && _ >= b\n{ return a + b; }\n\neffect rollDie(): Int uses random { }\n\ntest deterministic {\n  let sum = add(1, 2);\n  let first = rollDie();\n  let second = rollDie();\n}\n\n","transpiled_py":"# Generated by IntentLang\n# DO NOT EDIT MANUALLY\n\nfrom __main__ import Random, Result\n\n# TODO: Implementar un sistema de ordenación de tipos basado en dependencias en lugar de este enfoque simple de dos pasadas.\n\ndef add(a: int, b: int) -> int:\n    assert a >= 0 and b >= 0, \"Precondition failed\"\n    # TODO: Implementar la cláusula 'ensures'. Podría requerir decorar la función o inyectar aserciones antes de cada 'return'.\n    return a + b\n\ndef rollDie() -> int:\n    # TODO: Implementar la cláusula 'ensures' para efectos.\n    # Stmt type 'ExprStmt' not implemented\n\ndef test_deterministic():\n    # TODO: Añadir el setup del runtime (initRuntime) y el paso de dependencias a los tests que usan efectos.\n    sum = add(1, 2)\n    first = rollDie()\n    second = rollDie()","ast":{"kind":"Program","uses":{"kind":"UsesSection","entries":[{"kind":"UseDecl","name":{"kind":"Identifier","name":"random","span":{"start":{"line":1,"column":14,"index":13},"end":{"line":1,"column":14,"index":13}}},"typeName":{"kind":"Identifier","name":"Random","span":{"start":{"line":1,"column":23,"index":22},"end":{"line":1,"column":23,"index":22}}},"params":{},"span":{"start":{"line":1,"column":5,"index":4},"end":{"line":1,"column":5,"index":4}}}],"span":{"start":{"line":1,"column":5,"index":4},"end":{"line":1,"column":5,"index":4}}},"items":[{"kind":"UsesSection","entries":[{"kind":"UseDecl","name":{"kind":"Identifier","name":"random","span":{"start":{"line":1,"column":14,"index":13},"end":{"line":1,"column":14,"index":13}}},"typeName":{"kind":"Identifier","name":"Random","span":{"start":{"line":1,"column":23,"index":22},"end":{"line":1,"column":23,"index":22}}},"params":{},"span":{"start":{"line":1,"column":5,"index":4},"end":{"line":1,"column":5,"index":4}}}],"span":{"start":{"line":1,"column":5,"index":4},"end":{"line":1,"column":5,"index":4}}},{"kind":"FuncDecl","name":{"kind":"Identifier","name":"add","span":{"start":{"line":3,"column":9,"index":37},"end":{"line":3,"column":9,"index":37}}},"params":[{"kind":"ParamSig","name":{"kind":"Identifier","name":"a","span":{"start":{"line":3,"column":11,"index":39},"end":{"line":3,"column":11,"index":39}}},"type":{"kind":"BasicType","name":"Int","span":{"start":{"line":3,"column":16,"index":44},"end":{"line":3,"column":16,"index":44}}},"span":{"start":{"line":3,"column":11,"index":39},"end":{"line":3,"column":11,"index":39}}},{"kind":"ParamSig","name":{"kind":"Identifier","name":"b","span":{"start":{"line":3,"column":19,"index":47},"end":{"line":3,"column":19,"index":47}}},"type":{"kind":"BasicType","name":"Int","span":{"start":{"line":3,"column":24,"index":52},"end":{"line":3,"column":24,"index":52}}},"span":{"start":{"line":3,"column":19,"index":47},"end":{"line":3,"column":19,"index":47}}}],"returnType":{"kind":"BasicType","name":"Int","span":{"start":{"line":4,"column":11,"index":69},"end":{"line":4,"column":11,"index":69}}},"contracts":{"requires":{"kind":"BinaryExpr","op":"&&","left":{"kind":"BinaryExpr","op":">=","left":{"kind":"IdentifierExpr","id":{"kind":"Identifier","name":"a","span":{"start":{"line":4,"column":14,"index":72},"end":{"line":4,"column":14,"index":72}}},"span":{"start":{"line":4,"column":14,"index":72},"end":{"line":4,"column":14,"index":72}}},"right":{"kind":"LiteralExpr","value":{"kind":"Number","value":0,"span":{"start":{"line":4,"column":18,"index":76},"end":{"line":4,"column":18,"index":76}}},"span":{"start":{"line":4,"column":18,"index":76},"end":{"line":4,"column":18,"index":76}}},"span":{"start":{"line":4,"column":19,"index":77},"end":{"line":4,"column":19,"index":77}}},"right":{"kind":"BinaryExpr","op":">=","left":{"kind":"IdentifierExpr","id":{"kind":"Identifier","name":"b","span":{"start":{"line":4,"column":24,"index":82},"end":{"line":4,"column":24,"index":82}}},"span":{"start":{"line":4,"column":24,"index":82},"end":{"line":4,"column":24,"index":82}}},"right":{"kind":"LiteralExpr","value":{"kind":"Number","value":0,"span":{"start":{"line":4,"column":28,"index":86},"end":{"line":4,"column":28,"index":86}}},"span":{"start":{"line":4,"column":28,"index":86},"end":{"line":4,"column":28,"index":86}}},"span":{"start":{"line":5,"column":10,"index":96},"end":{"line":5,"column":10,"index":96}}},"span":{"start":{"line":5,"column":10,"index":96},"end":{"line":5,"column":10,"index":96}}},"ensures":{"kind":"BinaryExpr","op":"&&","left":{"kind":"BinaryExpr","op":">=","left":{"kind":"IdentifierExpr","id":{"kind":"Identifier","name":"_","span":{"start":{"line":5,"column":13,"index":99},"end":{"line":5,"column":13,"index":99}}},"span":{"start":{"line":5,"column":13,"index":99},"end":{"line":5,"column":13,"index":99}}},"right":{"kind":"IdentifierExpr","id":{"kind":"Identifier","name":"a","span":{"start":{"line":5,"column":18,"index":104},"end":{"line":5,"column":18,"index":104}}},"span":{"start":{"line":5,"column":18,"index":104},"end":{"line":5,"column":18,"index":104}}},"span":{"start":{"line":5,"column":18,"index":104},"end":{"line":5,"column":18,"index":104}}},"right":{"kind":"BinaryExpr","op":">=","left":{"kind":"IdentifierExpr","id":{"kind":"Identifier","name":"_","span":{"start":{"line":5,"column":23,"index":109},"end":{"line":5,"column":23,"index":109}}},"span":{"start":{"line":5,"column":23,"index":109},"end":{"line":5,"column":23,"index":109}}},"right":{"kind":"IdentifierExpr","id":{"kind":"Identifier","name":"b","span":{"start":{"line":6,"column":1,"index":114},"end":{"line":6,"column":1,"index":114}}},"span":{"start":{"line":6,"column":1,"index":114},"end":{"line":6,"column":1,"index":114}}},"span":{"start":{"line":6,"column":1,"index":114},"end":{"line":6,"column":1,"index":114}}},"span":{"start":{"line":6,"column":1,"index":114},"end":{"line":6,"column":1,"index":114}}}},"body":{"kind":"Block","statements":[{"kind":"ReturnStmt","argument":{"kind":"BinaryExpr","op":"+","left":{"kind":"IdentifierExpr","id":{"kind":"Identifier","name":"a","span":{"start":{"line":6,"column":12,"index":125},"end":{"line":6,"column":12,"index":125}}},"span":{"start":{"line":6,"column":12,"index":125},"end":{"line":6,"column":12,"index":125}}},"right":{"kind":"IdentifierExpr","id":{"kind":"Identifier","name":"b","span":{"start":{"line":6,"column":15,"index":128},"end":{"line":6,"column":15,"index":128}}},"span":{"start":{"line":6,"column":15,"index":128},"end":{"line":6,"column":15,"index":128}}},"span":{"start":{"line":6,"column":15,"index":128},"end":{"line":6,"column":15,"index":128}}},"span":{"start":{"line":6,"column":9,"index":122},"end":{"line":6,"column":9,"index":122}}}],"span":{"start":{"line":6,"column":1,"index":114},"end":{"line":6,"column":1,"index":114}}},"span":{"start":{"line":3,"column":5,"index":33},"end":{"line":3,"column":5,"index":33}}},{"kind":"EffectDecl","name":{"kind":"Identifier","name":"rollDie","span":{"start":{"line":8,"column":15,"index":147},"end":{"line":8,"column":15,"index":147}}},"params":[],"returnType":{"kind":"BasicType","name":"Int","span":{"start":{"line":8,"column":27,"index":159},"end":{"line":8,"column":27,"index":159}}},"uses":[{"kind":"Identifier","name":"random","span":{"start":{"line":8,"column":35,"index":167},"end":{"line":8,"column":35,"index":167}}}],"body":{"kind":"Block","statements":[],"span":{"start":{"line":8,"column":35,"index":167},"end":{"line":8,"column":35,"index":167}}},"span":{"start":{"line":8,"column":7,"index":139},"end":{"line":8,"column":7,"index":139}}},{"kind":"TestDecl","name":{"kind":"Identifier","name":"deterministic","span":{"start":{"line":10,"column":20,"index":191},"end":{"line":10,"column":20,"index":191}}},"body":{"kind":"TestBlock","statements":[{"kind":"LetStmt","id":{"kind":"Identifier","name":"sum","span":{"start":{"line":11,"column":11,"index":203},"end":{"line":11,"column":11,"index":203}}},"init":{"kind":"CallExpr","callee":{"kind":"IdentifierExpr","id":{"kind":"Identifier","name":"add","span":{"start":{"line":11,"column":16,"index":208},"end":{"line":11,"column":16,"index":208}}},"span":{"start":{"line":11,"column":16,"index":208},"end":{"line":11,"column":16,"index":208}}},"args":[{"kind":"LiteralExpr","value":{"kind":"Number","value":1,"span":{"start":{"line":11,"column":18,"index":210},"end":{"line":11,"column":18,"index":210}}},"span":{"start":{"line":11,"column":18,"index":210},"end":{"line":11,"column":18,"index":210}}},{"kind":"LiteralExpr","value":{"kind":"Number","value":2,"span":{"start":{"line":11,"column":21,"index":213},"end":{"line":11,"column":21,"index":213}}},"span":{"start":{"line":11,"column":21,"index":213},"end":{"line":11,"column":21,"index":213}}}],"span":{"start":{"line":11,"column":22,"index":214},"end":{"line":11,"column":22,"index":214}}},"span":{"start":{"line":11,"column":6,"index":198},"end":{"line":11,"column":6,"index":198}}},{"kind":"LetStmt","id":{"kind":"Identifier","name":"first","span":{"start":{"line":12,"column":13,"index":228},"end":{"line":12,"column":13,"index":228}}},"init":{"kind":"CallExpr","callee":{"kind":"IdentifierExpr","id":{"kind":"Identifier","name":"rollDie","span":{"start":{"line":12,"column":22,"index":237},"end":{"line":12,"column":22,"index":237}}},"span":{"start":{"line":12,"column":22,"index":237},"end":{"line":12,"column":22,"index":237}}},"args":[],"span":{"start":{"line":12,"column":24,"index":239},"end":{"line":12,"column":24,"index":239}}},"span":{"start":{"line":12,"column":6,"index":221},"end":{"line":12,"column":6,"index":221}}},{"kind":"LetStmt","id":{"kind":"Identifier","name":"second","span":{"start":{"line":13,"column":14,"index":254},"end":{"line":13,"column":14,"index":254}}},"init":{"kind":"CallExpr","callee":{"kind":"IdentifierExpr","id":{"kind":"Identifier","name":"rollDie","span":{"start":{"line":13,"column":23,"index":263},"end":{"line":13,"column":23,"index":263}}},"span":{"start":{"line":13,"column":23,"index":263},"end":{"line":13,"column":23,"index":263}}},"args":[],"span":{"start":{"line":13,"column":25,"index":265},"end":{"line":13,"column":25,"index":265}}},"span":{"start":{"line":13,"column":6,"index":246},"end":{"line":13,"column":6,"index":246}}}],"span":{"start":{"line":10,"column":20,"index":191},"end":{"line":10,"column":20,"index":191}}},"span":{"start":{"line":10,"column":5,"index":176},"end":{"line":10,"column":5,"index":176}}}],"span":{"start":{"line":1,"column":1,"index":0},"end":{"line":16,"column":1,"index":270}}}}
{"source_il":"types {\n  type Fixed2 = Int brand \"Fixed2\";\n}\n\nfunc mul(a: Fixed2, b: Fixed2): Fixed2\n{\n  return fixed2Mul(a, b);\n}\n","transpiled_py":"# Generated by IntentLang\n# DO NOT EDIT MANUALLY\n\nfrom __main__ import Result\n\n# TODO: Implementar un sistema de ordenación de tipos basado en dependencias en lugar de este enfoque simple de dos pasadas.\nFixed2 = NewType('Fixed2', int)\n\ndef mul(a: Fixed2, b: Fixed2) -> Fixed2:\n    # TODO: Implementar la cláusula 'ensures'. Podría requerir decorar la función o inyectar aserciones antes de cada 'return'.\n    return fixed2Mul(a, b)","ast":null}
{"source_il":"intent \"Invoice service\" tags [\"billing\",\"invoice\"]\r\n\r\nuses {\r\n  http: Http { baseUrl: \"https://api.example.com\", timeoutMs: 3000 },\r\n  clock: Clock {},\r\n}\r\n\r\ntypes {\r\n  type InvoiceId = Uuid;\r\n  type Invoice = {\r\n    id: InvoiceId,\r\n    orderId: Uuid,\r\n    issuedAt: DateTime,\r\n  };\r\n  type InvoiceError = { code: Int, message: String };\r\n}\r\n\r\neffect generateInvoice(orderId: Uuid): Result<Invoice, InvoiceError> uses http, clock {\n  return http.post(\"/invoices\", { orderId, issuedAt: clock.now() });\n}\n","transpiled_py":"# Generated by IntentLang\n# DO NOT EDIT MANUALLY\n\nfrom __main__ import Http, Clock, Result\n\n# TODO: Implementar un sistema de ordenación de tipos basado en dependencias en lugar de este enfoque simple de dos pasadas.\n@dataclass\nclass Invoice:\n    id: InvoiceId\n    orderId: str\n    issuedAt: datetime\n\n@dataclass\nclass InvoiceError:\n    code: int\n    message: str\n\nInvoiceId = str\n\nasync def generateInvoice(deps, orderId: str) -> Result[Invoice, InvoiceError]:\n    # TODO: Implementar la cláusula 'ensures' para efectos.\n    # Stmt type 'ExprStmt' not implemented","ast":{"kind":"Program","intent":{"kind":"IntentSection","description":"Invoice service","tags":["billing","invoice"],"span":{"start":{"line":1,"column":7,"index":6},"end":{"line":1,"column":7,"index":6}}},"uses":{"kind":"UsesSection","entries":[{"kind":"UseDecl","name":{"kind":"Identifier","name":"http","span":{"start":{"line":4,"column":7,"index":69},"end":{"line":4,"column":7,"index":69}}},"typeName":{"kind":"Identifier","name":"Http","span":{"start":{"line":4,"column":14,"index":76},"end":{"line":4,"column":14,"index":76}}},"params":{"baseUrl":{"kind":"String","value":"https://api.example.com","span":{"start":{"line":4,"column":50,"index":112},"end":{"line":4,"column":50,"index":112}}},"timeoutMs":{"kind":"Number","value":3000,"span":{"start":{"line":4,"column":67,"index":129},"end":{"line":4,"column":67,"index":129}}}},"span":{"start":{"line":3,"column":5,"index":59},"end":{"line":3,"column":5,"index":59}}},{"kind":"UseDecl","name":{"kind":"Identifier","name":"clock","span":{"start":{"line":5,"column":8,"index":141},"end":{"line":5,"column":8,"index":141}}},"typeName":{"kind":"Identifier","name":"Clock","span":{"start":{"line":5,"column":16,"index":149},"end":{"line":5,"column":16,"index":149}}},"params":{},"span":{"start":{"line":3,"column":5,"index":59},"end":{"line":3,"column":5,"index":59}}}],"span":{"start":{"line":3,"column":5,"index":59},"end":{"line":3,"column":5,"index":59}}},"types":{"kind":"TypesSection","declarations":[{"kind":"TypeDecl","name":{"kind":"Identifier","name":"InvoiceId","span":{"start":{"line":9,"column":18,"index":185},"end":{"line":9,"column":18,"index":185}}},"expr":{"kind":"BasicType","name":"Uuid","span":{"start":{"line":9,"column":24,"index":191},"end":{"line":9,"column":24,"index":191}}},"span":{"start":{"line":9,"column":7,"index":174},"end":{"line":9,"column":7,"index":174}}},{"kind":"TypeDecl","name":{"kind":"Identifier","name":"Invoice","span":{"start":{"line":10,"column":16,"index":209},"end":{"line":10,"column":16,"index":209}}},"expr":{"kind":"RecordType","fields":[{"kind":"RecordField","name":{"kind":"Identifier","name":"id","span":{"start":{"line":11,"column":7,"index":220},"end":{"line":11,"column":7,"index":220}}},"type":{"kind":"NamedType","name":{"kind":"Identifier","name":"InvoiceId","span":{"start":{"line":11,"column":18,"index":231},"end":{"line":11,"column":18,"index":231}}},"span":{"start":{"line":11,"column":18,"index":231},"end":{"line":11,"column":18,"index":231}}},"span":{"start":{"line":10,"column":18,"index":211},"end":{"line":10,"column":18,"index":211}}},{"kind":"RecordField","name":{"kind":"Identifier","name":"orderId","span":{"start":{"line":12,"column":12,"index":245},"end":{"line":12,"column":12,"index":245}}},"type":{"kind":"BasicType","name":"Uuid","span":{"start":{"line":12,"column":18,"index":251},"end":{"line":12,"column":18,"index":251}}},"span":{"start":{"line":10,"column":18,"index":211},"end":{"line":10,"column":18,"index":211}}},{"kind":"RecordField","name":{"kind":"Identifier","name":"issuedAt","span":{"start":{"line":13,"column":13,"index":266},"end":{"line":13,"column":13,"index":266}}},"type":{"kind":"BasicType","name":"DateTime","span":{"start":{"line":13,"column":23,"index":276},"end":{"line":13,"column":23,"index":276}}},"span":{"start":{"line":10,"column":18,"index":211},"end":{"line":10,"column":18,"index":211}}}],"span":{"start":{"line":10,"column":18,"index":211},"end":{"line":10,"column":18,"index":211}}},"span":{"start":{"line":10,"column":7,"index":200},"end":{"line":10,"column":7,"index":200}}},{"kind":"TypeDecl","name":{"kind":"Identifier","name":"InvoiceError","span":{"start":{"line":15,"column":21,"index":305},"end":{"line":15,"column":21,"index":305}}},"expr":{"kind":"RecordType","fields":[{"kind":"RecordField","name":{"kind":"Identifier","name":"code","span":{"start":{"line":15,"column":29,"index":313},"end":{"line":15,"column":29,"index":313}}},"type":{"kind":"BasicType","name":"Int","span":{"start":{"line":15,"column":34,"index":318},"end":{"line":15,"column":34,"index":318}}},"span":{"start":{"line":15,"column":23,"index":307},"end":{"line":15,"column":23,"index":307}}},{"kind":"RecordField","name":{"kind":"Identifier","name":"message","span":{"start":{"line":15,"column":43,"index":327},"end":{"line":15,"column":43,"index":327}}},"type":{"kind":"BasicType","name":"String","span":{"start":{"line":15,"column":52,"index":336},"end":{"line":15,"column":52,"index":336}}},"span":{"start":{"line":15,"column":23,"index":307},"end":{"line":15,"column":23,"index":307}}}],"span":{"start":{"line":15,"column":23,"index":307},"end":{"line":15,"column":23,"index":307}}},"span":{"start":{"line":15,"column":7,"index":291},"end":{"line":15,"column":7,"index":291}}}],"span":{"start":{"line":8,"column":6,"index":164},"end":{"line":8,"column":6,"index":164}}},"items":[{"kind":"IntentSection","description":"Invoice service","tags":["billing","invoice"],"span":{"start":{"line":1,"column":7,"index":6},"end":{"line":1,"column":7,"index":6}}},{"kind":"UsesSection","entries":[{"kind":"UseDecl","name":{"kind":"Identifier","name":"http","span":{"start":{"line":4,"column":7,"index":69},"end":{"line":4,"column":7,"index":69}}},"typeName":{"kind":"Identifier","name":"Http","span":{"start":{"line":4,"column":14,"index":76},"end":{"line":4,"column":14,"index":76}}},"params":{"baseUrl":{"kind":"String","value":"https://api.example.com","span":{"start":{"line":4,"column":50,"index":112},"end":{"line":4,"column":50,"index":112}}},"timeoutMs":{"kind":"Number","value":3000,"span":{"start":{"line":4,"column":67,"index":129},"end":{"line":4,"column":67,"index":129}}}},"span":{"start":{"line":3,"column":5,"index":59},"end":{"line":3,"column":5,"index":59}}},{"kind":"UseDecl","name":{"kind":"Identifier","name":"clock","span":{"start":{"line":5,"column":8,"index":141},"end":{"line":5,"column":8,"index":141}}},"typeName":{"kind":"Identifier","name":"Clock","span":{"start":{"line":5,"column":16,"index":149},"end":{"line":5,"column":16,"index":149}}},"params":{},"span":{"start":{"line":3,"column":5,"index":59},"end":{"line":3,"column":5,"index":59}}}],"span":{"start":{"line":3,"column":5,"index":59},"end":{"line":3,"column":5,"index":59}}},{"kind":"TypesSection","declarations":[{"kind":"TypeDecl","name":{"kind":"Identifier","name":"InvoiceId","span":{"start":{"line":9,"column":18,"index":185},"end":{"line":9,"column":18,"index":185}}},"expr":{"kind":"BasicType","name":"Uuid","span":{"start":{"line":9,"column":24,"index":191},"end":{"line":9,"column":24,"index":191}}},"span":{"start":{"line":9,"column":7,"index":174},"end":{"line":9,"column":7,"index":174}}},{"kind":"TypeDecl","name":{"kind":"Identifier","name":"Invoice","span":{"start":{"line":10,"column":16,"index":209},"end":{"line":10,"column":16,"index":209}}},"expr":{"kind":"RecordType","fields":[{"kind":"RecordField","name":{"kind":"Identifier","name":"id","span":{"start":{"line":11,"column":7,"index":220},"end":{"line":11,"column":7,"index":220}}},"type":{"kind":"NamedType","name":{"kind":"Identifier","name":"InvoiceId","span":{"start":{"line":11,"column":18,"index":231},"end":{"line":11,"column":18,"index":231}}},"span":{"start":{"line":11,"column":18,"index":231},"end":{"line":11,"column":18,"index":231}}},"span":{"start":{"line":10,"column":18,"index":211},"end":{"line":10,"column":18,"index":211}}},{"kind":"RecordField","name":{"kind":"Identifier","name":"orderId","span":{"start":{"line":12,"column":12,"index":245},"end":{"line":12,"column":12,"index":245}}},"type":{"kind":"BasicType","name":"Uuid","span":{"start":{"line":12,"column":18,"index":251},"end":{"line":12,"column":18,"index":251}}},"span":{"start":{"line":10,"column":18,"index":211},"end":{"line":10,"column":18,"index":211}}},{"kind":"RecordField","name":{"kind":"Identifier","name":"issuedAt","span":{"start":{"line":13,"column":13,"index":266},"end":{"line":13,"column":13,"index":266}}},"type":{"kind":"BasicType","name":"DateTime","span":{"start":{"line":13,"column":23,"index":276},"end":{"line":13,"column":23,"index":276}}},"span":{"start":{"line":10,"column":18,"index":211},"end":{"line":10,"column":18,"index":211}}}],"span":{"start":{"line":10,"column":18,"index":211},"end":{"line":10,"column":18,"index":211}}},"span":{"start":{"line":10,"column":7,"index":200},"end":{"line":10,"column":7,"index":200}}},{"kind":"TypeDecl","name":{"kind":"Identifier","name":"InvoiceError","span":{"start":{"line":15,"column":21,"index":305},"end":{"line":15,"column":21,"index":305}}},"expr":{"kind":"RecordType","fields":[{"kind":"RecordField","name":{"kind":"Identifier","name":"code","span":{"start":{"line":15,"column":29,"index":313},"end":{"line":15,"column":29,"index":313}}},"type":{"kind":"BasicType","name":"Int","span":{"start":{"line":15,"column":34,"index":318},"end":{"line":15,"column":34,"index":318}}},"span":{"start":{"line":15,"column":23,"index":307},"end":{"line":15,"column":23,"index":307}}},{"kind":"RecordField","name":{"kind":"Identifier","name":"message","span":{"start":{"line":15,"column":43,"index":327},"end":{"line":15,"column":43,"index":327}}},"type":{"kind":"BasicType","name":"String","span":{"start":{"line":15,"column":52,"index":336},"end":{"line":15,"column":52,"index":336}}},"span":{"start":{"line":15,"column":23,"index":307},"end":{"line":15,"column":23,"index":307}}}],"span":{"start":{"line":15,"column":23,"index":307},"end":{"line":15,"column":23,"index":307}}},"span":{"start":{"line":15,"column":7,"index":291},"end":{"line":15,"column":7,"index":291}}}],"span":{"start":{"line":8,"column":6,"index":164},"end":{"line":8,"column":6,"index":164}}},{"kind":"EffectDecl","name":{"kind":"Identifier","name":"generateInvoice","span":{"start":{"line":18,"column":23,"index":367},"end":{"line":18,"column":23,"index":367}}},"params":[{"kind":"ParamSig","name":{"kind":"Identifier","name":"orderId","span":{"start":{"line":18,"column":31,"index":375},"end":{"line":18,"column":31,"index":375}}},"type":{"kind":"BasicType","name":"Uuid","span":{"start":{"line":18,"column":37,"index":381},"end":{"line":18,"column":37,"index":381}}},"span":{"start":{"line":18,"column":31,"index":375},"end":{"line":18,"column":31,"index":375}}}],"returnType":{"kind":"GenericType","name":{"kind":"Identifier","name":"Result","span":{"start":{"line":18,"column":46,"index":390},"end":{"line":18,"column":46,"index":390}}},"params":[{"kind":"NamedType","name":{"kind":"Identifier","name":"Invoice","span":{"start":{"line":18,"column":54,"index":398},"end":{"line":18,"column":54,"index":398}}},"span":{"start":{"line":18,"column":54,"index":398},"end":{"line":18,"column":54,"index":398}}},{"kind":"NamedType","name":{"kind":"Identifier","name":"InvoiceError","span":{"start":{"line":18,"column":68,"index":412},"end":{"line":18,"column":68,"index":412}}},"span":{"start":{"line":18,"column":68,"index":412},"end":{"line":18,"column":68,"index":412}}}],"span":{"start":{"line":18,"column":46,"index":390},"end":{"line":18,"column":46,"index":390}}},"uses":[{"kind":"Identifier","name":"http","span":{"start":{"line":18,"column":79,"index":423},"end":{"line":18,"column":79,"index":423}}},{"kind":"Identifier","name":"clock","span":{"start":{"line":18,"column":87,"index":431},"end":{"line":18,"column":87,"index":431}}}],"body":{"kind":"Block","statements":[{"kind":"ReturnStmt","argument":{"kind":"CallExpr","callee":{"kind":"MemberExpr","object":{"kind":"IdentifierExpr","id":{"kind":"Identifier","name":"http","span":{"start":{"line":19,"column":14,"index":446},"end":{"line":19,"column":14,"index":446}}},"span":{"start":{"line":19,"column":14,"index":446},"end":{"line":19,"column":14,"index":446}}},"property":{"kind":"Identifier","name":"post","span":{"start":{"line":19,"column":19,"index":451},"end":{"line":19,"column":19,"index":451}}},"span":{"start":{"line":19,"column":19,"index":451},"end":{"line":19,"column":19,"index":451}}},"args":[{"kind":"LiteralExpr","value":{"kind":"String","value":"/invoices","span":{"start":{"line":19,"column":31,"index":463},"end":{"line":19,"column":31,"index":463}}},"span":{"start":{"line":19,"column":31,"index":463},"end":{"line":19,"column":31,"index":463}}},{"kind":"ObjectExpr","fields":[{"kind":"ObjectField","key":{"kind":"Identifier","name":"orderId","span":{"start":{"line":19,"column":42,"index":474},"end":{"line":19,"column":42,"index":474}}},"value":{"kind":"IdentifierExpr","id":{"kind":"Identifier","name":"orderId","span":{"start":{"line":19,"column":42,"index":474},"end":{"line":19,"column":42,"index":474}}},"span":{"start":{"line":19,"column":42,"index":474},"end":{"line":19,"column":42,"index":474}}},"span":{"start":{"line":19,"column":33,"index":465},"end":{"line":19,"column":33,"index":465}}},{"kind":"ObjectField","key":{"kind":"Identifier","name":"issuedAt","span":{"start":{"line":19,"column":52,"index":484},"end":{"line":19,"column":52,"index":484}}},"value":{"kind":"CallExpr","callee":{"kind":"MemberExpr","object":{"kind":"IdentifierExpr","id":{"kind":"Identifier","name":"clock","span":{"start":{"line":19,"column":59,"index":491},"end":{"line":19,"column":59,"index":491}}},"span":{"start":{"line":19,"column":59,"index":491},"end":{"line":19,"column":59,"index":491}}},"property":{"kind":"Identifier","name":"now","span":{"start":{"line":19,"column":63,"index":495},"end":{"line":19,"column":63,"index":495}}},"span":{"start":{"line":19,"column":63,"index":495},"end":{"line":19,"column":63,"index":495}}},"args":[],"span":{"start":{"line":19,"column":66,"index":498},"end":{"line":19,"column":66,"index":498}}},"span":{"start":{"line":19,"column":33,"index":465},"end":{"line":19,"column":33,"index":465}}}],"span":{"start":{"line":19,"column":33,"index":465},"end":{"line":19,"column":33,"index":465}}}],"span":{"start":{"line":19,"column":68,"index":500},"end":{"line":19,"column":68,"index":500}}},"span":{"start":{"line":19,"column":9,"index":441},"end":{"line":19,"column":9,"index":441}}}],"span":{"start":{"line":18,"column":87,"index":431},"end":{"line":18,"column":87,"index":431}}},"span":{"start":{"line":18,"column":7,"index":351},"end":{"line":18,"column":7,"index":351}}}],"span":{"start":{"line":1,"column":1,"index":0},"end":{"line":21,"column":1,"index":504}}}}
{"source_il":"intent \"Notification service\" tags [\"notifications\"]\r\n\r\nuses {\r\n  http: Http { baseUrl: \"https://api.example.com\", timeoutMs: 3000 },\r\n}\r\n\r\ntypes {\r\n  type NotificationId = Uuid;\r\n  type Notification = {\r\n    id: NotificationId,\r\n    userId: Uuid,\r\n    message: String,\r\n  };\r\n  type NotificationError = { code: Int, message: String };\r\n}\r\n\r\neffect sendNotification(input: { userId: Uuid, message: String }): Result<Notification, NotificationError> uses http {\n  return http.post(\"/notifications\", input);\n}\n","transpiled_py":"# Generated by IntentLang\n# DO NOT EDIT MANUALLY\n\nfrom __main__ import Http, Result\n\n# TODO: Implementar un sistema de ordenación de tipos basado en dependencias en lugar de este enfoque simple de dos pasadas.\n@dataclass\nclass Notification:\n    id: NotificationId\n    userId: str\n    message: str\n\n@dataclass\nclass NotificationError:\n    code: int\n    message: str\n\nNotificationId = str\n\nasync def sendNotification(deps, input: object) -> Result[Notification, NotificationError]:\n    # TODO: Implementar la cláusula 'ensures' para efectos.\n    # Stmt type 'ExprStmt' not implemented","ast":{"kind":"Program","intent":{"kind":"IntentSection","description":"Notification service","tags":["notifications"],"span":{"start":{"line":1,"column":7,"index":6},"end":{"line":1,"column":7,"index":6}}},"uses":{"kind":"UsesSection","entries":[{"kind":"UseDecl","name":{"kind":"Identifier","name":"http","span":{"start":{"line":4,"column":7,"index":70},"end":{"line":4,"column":7,"index":70}}},"typeName":{"kind":"Identifier","name":"Http","span":{"start":{"line":4,"column":14,"index":77},"end":{"line":4,"column":14,"index":77}}},"params":{"baseUrl":{"kind":"String","value":"https://api.example.com","span":{"start":{"line":4,"column":50,"index":113},"end":{"line":4,"column":50,"index":113}}},"timeoutMs":{"kind":"Number","value":3000,"span":{"start":{"line":4,"column":67,"index":130},"end":{"line":4,"column":67,"index":130}}}},"span":{"start":{"line":3,"column":5,"index":60},"end":{"line":3,"column":5,"index":60}}}],"span":{"start":{"line":3,"column":5,"index":60},"end":{"line":3,"column":5,"index":60}}},"types":{"kind":"TypesSection","declarations":[{"kind":"TypeDecl","name":{"kind":"Identifier","name":"NotificationId","span":{"start":{"line":8,"column":23,"index":171},"end":{"line":8,"column":23,"index":171}}},"expr":{"kind":"BasicType","name":"Uuid","span":{"start":{"line":8,"column":29,"index":177},"end":{"line":8,"column":29,"index":177}}},"span":{"start":{"line":8,"column":7,"index":155},"end":{"line":8,"column":7,"index":155}}},{"kind":"TypeDecl","name":{"kind":"Identifier","name":"Notification","span":{"start":{"line":9,"column":21,"index":200},"end":{"line":9,"column":21,"index":200}}},"expr":{"kind":"RecordType","fields":[{"kind":"RecordField","name":{"kind":"Identifier","name":"id","span":{"start":{"line":10,"column":7,"index":211},"end":{"line":10,"column":7,"index":211}}},"type":{"kind":"NamedType","name":{"kind":"Identifier","name":"NotificationId","span":{"start":{"line":10,"column":23,"index":227},"end":{"line":10,"column":23,"index":227}}},"span":{"start":{"line":10,"column":23,"index":227},"end":{"line":10,"column":23,"index":227}}},"span":{"start":{"line":9,"column":23,"index":202},"end":{"line":9,"column":23,"index":202}}},{"kind":"RecordField","name":{"kind":"Identifier","name":"userId","span":{"start":{"line":11,"column":11,"index":240},"end":{"line":11,"column":11,"index":240}}},"type":{"kind":"BasicType","name":"Uuid","span":{"start":{"line":11,"column":17,"index":246},"end":{"line":11,"column":17,"index":246}}},"span":{"start":{"line":9,"column":23,"index":202},"end":{"line":9,"column":23,"index":202}}},{"kind":"RecordField","name":{"kind":"Identifier","name":"message","span":{"start":{"line":12,"column":12,"index":260},"end":{"line":12,"column":12,"index":260}}},"type":{"kind":"BasicType","name":"String","span":{"start":{"line":12,"column":20,"index":268},"end":{"line":12,"column":20,"index":268}}},"span":{"start":{"line":9,"column":23,"index":202},"end":{"line":9,"column":23,"index":202}}}],"span":{"start":{"line":9,"column":23,"index":202},"end":{"line":9,"column":23,"index":202}}},"span":{"start":{"line":9,"column":7,"index":186},"end":{"line":9,"column":7,"index":186}}},{"kind":"TypeDecl","name":{"kind":"Identifier","name":"NotificationError","span":{"start":{"line":14,"column":26,"index":302},"end":{"line":14,"column":26,"index":302}}},"expr":{"kind":"RecordType","fields":[{"kind":"RecordField","name":{"kind":"Identifier","name":"code","span":{"start":{"line":14,"column":34,"index":310},"end":{"line":14,"column":34,"index":310}}},"type":{"kind":"BasicType","name":"Int","span":{"start":{"line":14,"column":39,"index":315},"end":{"line":14,"column":39,"index":315}}},"span":{"start":{"line":14,"column":28,"index":304},"end":{"line":14,"column":28,"index":304}}},{"kind":"RecordField","name":{"kind":"Identifier","name":"message","span":{"start":{"line":14,"column":48,"index":324},"end":{"line":14,"column":48,"index":324}}},"type":{"kind":"BasicType","name":"String","span":{"start":{"line":14,"column":57,"index":333},"end":{"line":14,"column":57,"index":333}}},"span":{"start":{"line":14,"column":28,"index":304},"end":{"line":14,"column":28,"index":304}}}],"span":{"start":{"line":14,"column":28,"index":304},"end":{"line":14,"column":28,"index":304}}},"span":{"start":{"line":14,"column":7,"index":283},"end":{"line":14,"column":7,"index":283}}}],"span":{"start":{"line":7,"column":6,"index":145},"end":{"line":7,"column":6,"index":145}}},"items":[{"kind":"IntentSection","description":"Notification service","tags":["notifications"],"span":{"start":{"line":1,"column":7,"index":6},"end":{"line":1,"column":7,"index":6}}},{"kind":"UsesSection","entries":[{"kind":"UseDecl","name":{"kind":"Identifier","name":"http","span":{"start":{"line":4,"column":7,"index":70},"end":{"line":4,"column":7,"index":70}}},"typeName":{"kind":"Identifier","name":"Http","span":{"start":{"line":4,"column":14,"index":77},"end":{"line":4,"column":14,"index":77}}},"params":{"baseUrl":{"kind":"String","value":"https://api.example.com","span":{"start":{"line":4,"column":50,"index":113},"end":{"line":4,"column":50,"index":113}}},"timeoutMs":{"kind":"Number","value":3000,"span":{"start":{"line":4,"column":67,"index":130},"end":{"line":4,"column":67,"index":130}}}},"span":{"start":{"line":3,"column":5,"index":60},"end":{"line":3,"column":5,"index":60}}}],"span":{"start":{"line":3,"column":5,"index":60},"end":{"line":3,"column":5,"index":60}}},{"kind":"TypesSection","declarations":[{"kind":"TypeDecl","name":{"kind":"Identifier","name":"NotificationId","span":{"start":{"line":8,"column":23,"index":171},"end":{"line":8,"column":23,"index":171}}},"expr":{"kind":"BasicType","name":"Uuid","span":{"start":{"line":8,"column":29,"index":177},"end":{"line":8,"column":29,"index":177}}},"span":{"start":{"line":8,"column":7,"index":155},"end":{"line":8,"column":7,"index":155}}},{"kind":"TypeDecl","name":{"kind":"Identifier","name":"Notification","span":{"start":{"line":9,"column":21,"index":200},"end":{"line":9,"column":21,"index":200}}},"expr":{"kind":"RecordType","fields":[{"kind":"RecordField","name":{"kind":"Identifier","name":"id","span":{"start":{"line":10,"column":7,"index":211},"end":{"line":10,"column":7,"index":211}}},"type":{"kind":"NamedType","name":{"kind":"Identifier","name":"NotificationId","span":{"start":{"line":10,"column":23,"index":227},"end":{"line":10,"column":23,"index":227}}},"span":{"start":{"line":10,"column":23,"index":227},"end":{"line":10,"column":23,"index":227}}},"span":{"start":{"line":9,"column":23,"index":202},"end":{"line":9,"column":23,"index":202}}},{"kind":"RecordField","name":{"kind":"Identifier","name":"userId","span":{"start":{"line":11,"column":11,"index":240},"end":{"line":11,"column":11,"index":240}}},"type":{"kind":"BasicType","name":"Uuid","span":{"start":{"line":11,"column":17,"index":246},"end":{"line":11,"column":17,"index":246}}},"span":{"start":{"line":9,"column":23,"index":202},"end":{"line":9,"column":23,"index":202}}},{"kind":"RecordField","name":{"kind":"Identifier","name":"message","span":{"start":{"line":12,"column":12,"index":260},"end":{"line":12,"column":12,"index":260}}},"type":{"kind":"BasicType","name":"String","span":{"start":{"line":12,"column":20,"index":268},"end":{"line":12,"column":20,"index":268}}},"span":{"start":{"line":9,"column":23,"index":202},"end":{"line":9,"column":23,"index":202}}}],"span":{"start":{"line":9,"column":23,"index":202},"end":{"line":9,"column":23,"index":202}}},"span":{"start":{"line":9,"column":7,"index":186},"end":{"line":9,"column":7,"index":186}}},{"kind":"TypeDecl","name":{"kind":"Identifier","name":"NotificationError","span":{"start":{"line":14,"column":26,"index":302},"end":{"line":14,"column":26,"index":302}}},"expr":{"kind":"RecordType","fields":[{"kind":"RecordField","name":{"kind":"Identifier","name":"code","span":{"start":{"line":14,"column":34,"index":310},"end":{"line":14,"column":34,"index":310}}},"type":{"kind":"BasicType","name":"Int","span":{"start":{"line":14,"column":39,"index":315},"end":{"line":14,"column":39,"index":315}}},"span":{"start":{"line":14,"column":28,"index":304},"end":{"line":14,"column":28,"index":304}}},{"kind":"RecordField","name":{"kind":"Identifier","name":"message","span":{"start":{"line":14,"column":48,"index":324},"end":{"line":14,"column":48,"index":324}}},"type":{"kind":"BasicType","name":"String","span":{"start":{"line":14,"column":57,"index":333},"end":{"line":14,"column":57,"index":333}}},"span":{"start":{"line":14,"column":28,"index":304},"end":{"line":14,"column":28,"index":304}}}],"span":{"start":{"line":14,"column":28,"index":304},"end":{"line":14,"column":28,"index":304}}},"span":{"start":{"line":14,"column":7,"index":283},"end":{"line":14,"column":7,"index":283}}}],"span":{"start":{"line":7,"column":6,"index":145},"end":{"line":7,"column":6,"index":145}}},{"kind":"EffectDecl","name":{"kind":"Identifier","name":"sendNotification","span":{"start":{"line":17,"column":24,"index":365},"end":{"line":17,"column":24,"index":365}}},"params":[{"kind":"ParamSig","name":{"kind":"Identifier","name":"input","span":{"start":{"line":17,"column":30,"index":371},"end":{"line":17,"column":30,"index":371}}},"type":{"kind":"RecordType","fields":[{"kind":"RecordField","name":{"kind":"Identifier","name":"userId","span":{"start":{"line":17,"column":40,"index":381},"end":{"line":17,"column":40,"index":381}}},"type":{"kind":"BasicType","name":"Uuid","span":{"start":{"line":17,"column":46,"index":387},"end":{"line":17,"column":46,"index":387}}},"span":{"start":{"line":17,"column":32,"index":373},"end":{"line":17,"column":32,"index":373}}},{"kind":"RecordField","name":{"kind":"Identifier","name":"message","span":{"start":{"line":17,"column":55,"index":396},"end":{"line":17,"column":55,"index":396}}},"type":{"kind":"BasicType","name":"String","span":{"start":{"line":17,"column":64,"index":405},"end":{"line":17,"column":64,"index":405}}},"span":{"start":{"line":17,"column":32,"index":373},"end":{"line":17,"column":32,"index":373}}}],"span":{"start":{"line":17,"column":32,"index":373},"end":{"line":17,"column":32,"index":373}}},"span":{"start":{"line":17,"column":30,"index":371},"end":{"line":17,"column":30,"index":371}}}],"returnType":{"kind":"GenericType","name":{"kind":"Identifier","name":"Result","span":{"start":{"line":17,"column":74,"index":415},"end":{"line":17,"column":74,"index":415}}},"params":[{"kind":"NamedType","name":{"kind":"Identifier","name":"Notification","span":{"start":{"line":17,"column":87,"index":428},"end":{"line":17,"column":87,"index":428}}},"span":{"start":{"line":17,"column":87,"index":428},"end":{"line":17,"column":87,"index":428}}},{"kind":"NamedType","name":{"kind":"Identifier","name":"NotificationError","span":{"start":{"line":17,"column":106,"index":447},"end":{"line":17,"column":106,"index":447}}},"span":{"start":{"line":17,"column":106,"index":447},"end":{"line":17,"column":106,"index":447}}}],"span":{"start":{"line":17,"column":74,"index":415},"end":{"line":17,"column":74,"index":415}}},"uses":[{"kind":"Identifier","name":"http","span":{"start":{"line":17,"column":118,"index":459},"end":{"line":17,"column":118,"index":459}}}],"body":{"kind":"Block","statements":[{"kind":"ReturnStmt","argument":{"kind":"CallExpr","callee":{"kind":"MemberExpr","object":{"kind":"IdentifierExpr","id":{"kind":"Identifier","name":"http","span":{"start":{"line":18,"column":14,"index":474},"end":{"line":18,"column":14,"index":474}}},"span":{"start":{"line":18,"column":14,"index":474},"end":{"line":18,"column":14,"index":474}}},"property":{"kind":"Identifier","name":"post","span":{"start":{"line":18,"column":19,"index":479},"end":{"line":18,"column":19,"index":479}}},"span":{"start":{"line":18,"column":19,"index":479},"end":{"line":18,"column":19,"index":479}}},"args":[{"kind":"LiteralExpr","value":{"kind":"String","value":"/notifications","span":{"start":{"line":18,"column":36,"index":496},"end":{"line":18,"column":36,"index":496}}},"span":{"start":{"line":18,"column":36,"index":496},"end":{"line":18,"column":36,"index":496}}},{"kind":"IdentifierExpr","id":{"kind":"Identifier","name":"input","span":{"start":{"line":18,"column":43,"index":503},"end":{"line":18,"column":43,"index":503}}},"span":{"start":{"line":18,"column":43,"index":503},"end":{"line":18,"column":43,"index":503}}}],"span":{"start":{"line":18,"column":44,"index":504},"end":{"line":18,"column":44,"index":504}}},"span":{"start":{"line":18,"column":9,"index":469},"end":{"line":18,"column":9,"index":469}}}],"span":{"start":{"line":17,"column":118,"index":459},"end":{"line":17,"column":118,"index":459}}},"span":{"start":{"line":17,"column":7,"index":348},"end":{"line":17,"column":7,"index":348}}}],"span":{"start":{"line":1,"column":1,"index":0},"end":{"line":20,"column":1,"index":508}}}}
{"source_il":"intent \"Order service\" tags [\"api\",\"orders\"]\r\n\r\nuses {\r\n  http: Http { baseUrl: \"https://api.example.com\", timeoutMs: 3000 },\r\n  random: Random { seed: 42 },\r\n}\r\n\r\ntypes {\r\n  type OrderId = Uuid;\r\n  type Order = {\r\n    id: OrderId,\r\n    userId: Uuid,\r\n    total: Float where _ >= 0,\r\n  };\r\n  type OrderError = { code: Int, message: String };\r\n}\r\n\r\neffect createOrder(input: { userId: Uuid, total: Float }): Result<Order, OrderError> uses http, random {\n  let id = random.next().toString();\n  return http.post(\"/orders\", { id: id as OrderId, userId: input.userId, total: input.total });\n}\n","transpiled_py":"# Generated by IntentLang\n# DO NOT EDIT MANUALLY\n\nfrom __main__ import Http, Random, Result\n\n# TODO: Implementar un sistema de ordenación de tipos basado en dependencias en lugar de este enfoque simple de dos pasadas.\n@dataclass\nclass Order:\n    id: OrderId\n    userId: str\n    total: float\n\n@dataclass\nclass OrderError:\n    code: int\n    message: str\n\nOrderId = str\n\nasync def createOrder(deps, input: object) -> Result[Order, OrderError]:\n    # TODO: Implementar la cláusula 'ensures' para efectos.\n    # Stmt type 'ExprStmt' not implemented","ast":{"kind":"Program","intent":{"kind":"IntentSection","description":"Order service","tags":["api","orders"],"span":{"start":{"line":1,"column":7,"index":6},"end":{"line":1,"column":7,"index":6}}},"uses":{"kind":"UsesSection","entries":[{"kind":"UseDecl","name":{"kind":"Identifier","name":"http","span":{"start":{"line":4,"column":7,"index":62},"end":{"line":4,"column":7,"index":62}}},"typeName":{"kind":"Identifier","name":"Http","span":{"start":{"line":4,"column":14,"index":69},"end":{"line":4,"column":14,"index":69}}},"params":{"baseUrl":{"kind":"String","value":"https://api.example.com","span":{"start":{"line":4,"column":50,"index":105},"end":{"line":4,"column":50,"index":105}}},"timeoutMs":{"kind":"Number","value":3000,"span":{"start":{"line":4,"column":67,"index":122},"end":{"line":4,"column":67,"index":122}}}},"span":{"start":{"line":3,"column":5,"index":52},"end":{"line":3,"column":5,"index":52}}},{"kind":"UseDecl","name":{"kind":"Identifier","name":"random","span":{"start":{"line":5,"column":9,"index":135},"end":{"line":5,"column":9,"index":135}}},"typeName":{"kind":"Identifier","name":"Random","span":{"start":{"line":5,"column":18,"index":144},"end":{"line":5,"column":18,"index":144}}},"params":{"seed":{"kind":"Number","value":42,"span":{"start":{"line":5,"column":28,"index":154},"end":{"line":5,"column":28,"index":154}}}},"span":{"start":{"line":3,"column":5,"index":52},"end":{"line":3,"column":5,"index":52}}}],"span":{"start":{"line":3,"column":5,"index":52},"end":{"line":3,"column":5,"index":52}}},"types":{"kind":"TypesSection","declarations":[{"kind":"TypeDecl","name":{"kind":"Identifier","name":"OrderId","span":{"start":{"line":9,"column":16,"index":188},"end":{"line":9,"column":16,"index":188}}},"expr":{"kind":"BasicType","name":"Uuid","span":{"start":{"line":9,"column":22,"index":194},"end":{"line":9,"column":22,"index":194}}},"span":{"start":{"line":9,"column":7,"index":179},"end":{"line":9,"column":7,"index":179}}},{"kind":"TypeDecl","name":{"kind":"Identifier","name":"Order","span":{"start":{"line":10,"column":14,"index":210},"end":{"line":10,"column":14,"index":210}}},"expr":{"kind":"RecordType","fields":[{"kind":"RecordField","name":{"kind":"Identifier","name":"id","span":{"start":{"line":11,"column":7,"index":221},"end":{"line":11,"column":7,"index":221}}},"type":{"kind":"NamedType","name":{"kind":"Identifier","name":"OrderId","span":{"start":{"line":11,"column":16,"index":230},"end":{"line":11,"column":16,"index":230}}},"span":{"start":{"line":11,"column":16,"index":230},"end":{"line":11,"column":16,"index":230}}},"span":{"start":{"line":10,"column":16,"index":212},"end":{"line":10,"column":16,"index":212}}},{"kind":"RecordField","name":{"kind":"Identifier","name":"userId","span":{"start":{"line":12,"column":11,"index":243},"end":{"line":12,"column":11,"index":243}}},"type":{"kind":"BasicType","name":"Uuid","span":{"start":{"line":12,"column":17,"index":249},"end":{"line":12,"column":17,"index":249}}},"span":{"start":{"line":10,"column":16,"index":212},"end":{"line":10,"column":16,"index":212}}},{"kind":"RecordField","name":{"kind":"Identifier","name":"total","span":{"start":{"line":13,"column":10,"index":261},"end":{"line":13,"column":10,"index":261}}},"type":{"kind":"BasicType","name":"Float","span":{"start":{"line":13,"column":23,"index":274},"end":{"line":13,"column":23,"index":274}}},"refinement":"_ >= 0","span":{"start":{"line":10,"column":16,"index":212},"end":{"line":10,"column":16,"index":212}}}],"span":{"start":{"line":10,"column":16,"index":212},"end":{"line":10,"column":16,"index":212}}},"span":{"start":{"line":10,"column":7,"index":203},"end":{"line":10,"column":7,"index":203}}},{"kind":"TypeDecl","name":{"kind":"Identifier","name":"OrderError","span":{"start":{"line":15,"column":19,"index":308},"end":{"line":15,"column":19,"index":308}}},"expr":{"kind":"RecordType","fields":[{"kind":"RecordField","name":{"kind":"Identifier","name":"code","span":{"start":{"line":15,"column":27,"index":316},"end":{"line":15,"column":27,"index":316}}},"type":{"kind":"BasicType","name":"Int","span":{"start":{"line":15,"column":32,"index":321},"end":{"line":15,"column":32,"index":321}}},"span":{"start":{"line":15,"column":21,"index":310},"end":{"line":15,"column":21,"index":310}}},{"kind":"RecordField","name":{"kind":"Identifier","name":"message","span":{"start":{"line":15,"column":41,"index":330},"end":{"line":15,"column":41,"index":330}}},"type":{"kind":"BasicType","name":"String","span":{"start":{"line":15,"column":50,"index":339},"end":{"line":15,"column":50,"index":339}}},"span":{"start":{"line":15,"column":21,"index":310},"end":{"line":15,"column":21,"index":310}}}],"span":{"start":{"line":15,"column":21,"index":310},"end":{"line":15,"column":21,"index":310}}},"span":{"start":{"line":15,"column":7,"index":296},"end":{"line":15,"column":7,"index":296}}}],"span":{"start":{"line":8,"column":6,"index":169},"end":{"line":8,"column":6,"index":169}}},"items":[{"kind":"IntentSection","description":"Order service","tags":["api","orders"],"span":{"start":{"line":1,"column":7,"index":6},"end":{"line":1,"column":7,"index":6}}},{"kind":"UsesSection","entries":[{"kind":"UseDecl","name":{"kind":"Identifier","name":"http","span":{"start":{"line":4,"column":7,"index":62},"end":{"line":4,"column":7,"index":62}}},"typeName":{"kind":"Identifier","name":"Http","span":{"start":{"line":4,"column":14,"index":69},"end":{"line":4,"column":14,"index":69}}},"params":{"baseUrl":{"kind":"String","value":"https://api.example.com","span":{"start":{"line":4,"column":50,"index":105},"end":{"line":4,"column":50,"index":105}}},"timeoutMs":{"kind":"Number","value":3000,"span":{"start":{"line":4,"column":67,"index":122},"end":{"line":4,"column":67,"index":122}}}},"span":{"start":{"line":3,"column":5,"index":52},"end":{"line":3,"column":5,"index":52}}},{"kind":"UseDecl","name":{"kind":"Identifier","name":"random","span":{"start":{"line":5,"column":9,"index":135},"end":{"line":5,"column":9,"index":135}}},"typeName":{"kind":"Identifier","name":"Random","span":{"start":{"line":5,"column":18,"index":144},"end":{"line":5,"column":18,"index":144}}},"params":{"seed":{"kind":"Number","value":42,"span":{"start":{"line":5,"column":28,"index":154},"end":{"line":5,"column":28,"index":154}}}},"span":{"start":{"line":3,"column":5,"index":52},"end":{"line":3,"column":5,"index":52}}}],"span":{"start":{"line":3,"column":5,"index":52},"end":{"line":3,"column":5,"index":52}}},{"kind":"TypesSection","declarations":[{"kind":"TypeDecl","name":{"kind":"Identifier","name":"OrderId","span":{"start":{"line":9,"column":16,"index":188},"end":{"line":9,"column":16,"index":188}}},"expr":{"kind":"BasicType","name":"Uuid","span":{"start":{"line":9,"column":22,"index":194},"end":{"line":9,"column":22,"index":194}}},"span":{"start":{"line":9,"column":7,"index":179},"end":{"line":9,"column":7,"index":179}}},{"kind":"TypeDecl","name":{"kind":"Identifier","name":"Order","span":{"start":{"line":10,"column":14,"index":210},"end":{"line":10,"column":14,"index":210}}},"expr":{"kind":"RecordType","fields":[{"kind":"RecordField","name":{"kind":"Identifier","name":"id","span":{"start":{"line":11,"column":7,"index":221},"end":{"line":11,"column":7,"index":221}}},"type":{"kind":"NamedType","name":{"kind":"Identifier","name":"OrderId","span":{"start":{"line":11,"column":16,"index":230},"end":{"line":11,"column":16,"index":230}}},"span":{"start":{"line":11,"column":16,"index":230},"end":{"line":11,"column":16,"index":230}}},"span":{"start":{"line":10,"column":16,"index":212},"end":{"line":10,"column":16,"index":212}}},{"kind":"RecordField","name":{"kind":"Identifier","name":"userId","span":{"start":{"line":12,"column":11,"index":243},"end":{"line":12,"column":11,"index":243}}},"type":{"kind":"BasicType","name":"Uuid","span":{"start":{"line":12,"column":17,"index":249},"end":{"line":12,"column":17,"index":249}}},"span":{"start":{"line":10,"column":16,"index":212},"end":{"line":10,"column":16,"index":212}}},{"kind":"RecordField","name":{"kind":"Identifier","name":"total","span":{"start":{"line":13,"column":10,"index":261},"end":{"line":13,"column":10,"index":261}}},"type":{"kind":"BasicType","name":"Float","span":{"start":{"line":13,"column":23,"index":274},"end":{"line":13,"column":23,"index":274}}},"refinement":"_ >= 0","span":{"start":{"line":10,"column":16,"index":212},"end":{"line":10,"column":16,"index":212}}}],"span":{"start":{"line":10,"column":16,"index":212},"end":{"line":10,"column":16,"index":212}}},"span":{"start":{"line":10,"column":7,"index":203},"end":{"line":10,"column":7,"index":203}}},{"kind":"TypeDecl","name":{"kind":"Identifier","name":"OrderError","span":{"start":{"line":15,"column":19,"index":308},"end":{"line":15,"column":19,"index":308}}},"expr":{"kind":"RecordType","fields":[{"kind":"RecordField","name":{"kind":"Identifier","name":"code","span":{"start":{"line":15,"column":27,"index":316},"end":{"line":15,"column":27,"index":316}}},"type":{"kind":"BasicType","name":"Int","span":{"start":{"line":15,"column":32,"index":321},"end":{"line":15,"column":32,"index":321}}},"span":{"start":{"line":15,"column":21,"index":310},"end":{"line":15,"column":21,"index":310}}},{"kind":"RecordField","name":{"kind":"Identifier","name":"message","span":{"start":{"line":15,"column":41,"index":330},"end":{"line":15,"column":41,"index":330}}},"type":{"kind":"BasicType","name":"String","span":{"start":{"line":15,"column":50,"index":339},"end":{"line":15,"column":50,"index":339}}},"span":{"start":{"line":15,"column":21,"index":310},"end":{"line":15,"column":21,"index":310}}}],"span":{"start":{"line":15,"column":21,"index":310},"end":{"line":15,"column":21,"index":310}}},"span":{"start":{"line":15,"column":7,"index":296},"end":{"line":15,"column":7,"index":296}}}],"span":{"start":{"line":8,"column":6,"index":169},"end":{"line":8,"column":6,"index":169}}},{"kind":"EffectDecl","name":{"kind":"Identifier","name":"createOrder","span":{"start":{"line":18,"column":19,"index":366},"end":{"line":18,"column":19,"index":366}}},"params":[{"kind":"ParamSig","name":{"kind":"Identifier","name":"input","span":{"start":{"line":18,"column":25,"index":372},"end":{"line":18,"column":25,"index":372}}},"type":{"kind":"RecordType","fields":[{"kind":"RecordField","name":{"kind":"Identifier","name":"userId","span":{"start":{"line":18,"column":35,"index":382},"end":{"line":18,"column":35,"index":382}}},"type":{"kind":"BasicType","name":"Uuid","span":{"start":{"line":18,"column":41,"index":388},"end":{"line":18,"column":41,"index":388}}},"span":{"start":{"line":18,"column":27,"index":374},"end":{"line":18,"column":27,"index":374}}},{"kind":"RecordField","name":{"kind":"Identifier","name":"total","span":{"start":{"line":18,"column":48,"index":395},"end":{"line":18,"column":48,"index":395}}},"type":{"kind":"BasicType","name":"Float","span":{"start":{"line":18,"column":56,"index":403},"end":{"line":18,"column":56,"index":403}}},"span":{"start":{"line":18,"column":27,"index":374},"end":{"line":18,"column":27,"index":374}}}],"span":{"start":{"line":18,"column":27,"index":374},"end":{"line":18,"column":27,"index":374}}},"span":{"start":{"line":18,"column":25,"index":372},"end":{"line":18,"column":25,"index":372}}}],"returnType":{"kind":"GenericType","name":{"kind":"Identifier","name":"Result","span":{"start":{"line":18,"column":66,"index":413},"end":{"line":18,"column":66,"index":413}}},"params":[{"kind":"NamedType","name":{"kind":"Identifier","name":"Order","span":{"start":{"line":18,"column":72,"index":419},"end":{"line":18,"column":72,"index":419}}},"span":{"start":{"line":18,"column":72,"index":419},"end":{"line":18,"column":72,"index":419}}},{"kind":"NamedType","name":{"kind":"Identifier","name":"OrderError","span":{"start":{"line":18,"column":84,"index":431},"end":{"line":18,"column":84,"index":431}}},"span":{"start":{"line":18,"column":84,"index":431},"end":{"line":18,"column":84,"index":431}}}],"span":{"start":{"line":18,"column":66,"index":413},"end":{"line":18,"column":66,"index":413}}},"uses":[{"kind":"Identifier","name":"http","span":{"start":{"line":18,"column":95,"index":442},"end":{"line":18,"column":95,"index":442}}},{"kind":"Identifier","name":"random","span":{"start":{"line":18,"column":104,"index":451},"end":{"line":18,"column":104,"index":451}}}],"body":{"kind":"Block","statements":[{"kind":"LetStmt","id":{"kind":"Identifier","name":"id","span":{"start":{"line":19,"column":10,"index":462},"end":{"line":19,"column":10,"index":462}}},"init":{"kind":"CallExpr","callee":{"kind":"MemberExpr","object":{"kind":"CallExpr","callee":{"kind":"MemberExpr","object":{"kind":"IdentifierExpr","id":{"kind":"Identifier","name":"random","span":{"start":{"line":19,"column":18,"index":470},"end":{"line":19,"column":18,"index":470}}},"span":{"start":{"line":19,"column":18,"index":470},"end":{"line":19,"column":18,"index":470}}},"property":{"kind":"Identifier","name":"next","span":{"start":{"line":19,"column":23,"index":475},"end":{"line":19,"column":23,"index":475}}},"span":{"start":{"line":19,"column":23,"index":475},"end":{"line":19,"column":23,"index":475}}},"args":[],"span":{"start":{"line":19,"column":25,"index":477},"end":{"line":19,"column":25,"index":477}}},"property":{"kind":"Identifier","name":"toString","span":{"start":{"line":19,"column":34,"index":486},"end":{"line":19,"column":34,"index":486}}},"span":{"start":{"line":19,"column":34,"index":486},"end":{"line":19,"column":34,"index":486}}},"args":[],"span":{"start":{"line":19,"column":36,"index":488},"end":{"line":19,"column":36,"index":488}}},"span":{"start":{"line":19,"column":6,"index":458},"end":{"line":19,"column":6,"index":458}}},{"kind":"ReturnStmt","argument":{"kind":"CallExpr","callee":{"kind":"MemberExpr","object":{"kind":"IdentifierExpr","id":{"kind":"Identifier","name":"http","span":{"start":{"line":20,"column":14,"index":503},"end":{"line":20,"column":14,"index":503}}},"span":{"start":{"line":20,"column":14,"index":503},"end":{"line":20,"column":14,"index":503}}},"property":{"kind":"Identifier","name":"post","span":{"start":{"line":20,"column":19,"index":508},"end":{"line":20,"column":19,"index":508}}},"span":{"start":{"line":20,"column":19,"index":508},"end":{"line":20,"column":19,"index":508}}},"args":[{"kind":"LiteralExpr","value":{"kind":"String","value":"/orders","span":{"start":{"line":20,"column":29,"index":518},"end":{"line":20,"column":29,"index":518}}},"span":{"start":{"line":20,"column":29,"index":518},"end":{"line":20,"column":29,"index":518}}},{"kind":"ObjectExpr","fields":[{"kind":"ObjectField","key":{"kind":"Identifier","name":"id","span":{"start":{"line":20,"column":35,"index":524},"end":{"line":20,"column":35,"index":524}}},"value":{"kind":"IdentifierExpr","id":{"kind":"Identifier","name":"id","span":{"start":{"line":20,"column":42,"index":531},"end":{"line":20,"column":42,"index":531}}},"span":{"start":{"line":20,"column":42,"index":531},"end":{"line":20,"column":42,"index":531}}},"span":{"start":{"line":20,"column":31,"index":520},"end":{"line":20,"column":31,"index":520}}},{"kind":"ObjectField","key":{"kind":"Identifier","name":"as","span":{"start":{"line":20,"column":50,"index":539},"end":{"line":20,"column":50,"index":539}}},"value":{"kind":"IdentifierExpr","id":{"kind":"Identifier","name":"as","span":{"start":{"line":20,"column":50,"index":539},"end":{"line":20,"column":50,"index":539}}},"span":{"start":{"line":20,"column":50,"index":539},"end":{"line":20,"column":50,"index":539}}},"span":{"start":{"line":20,"column":31,"index":520},"end":{"line":20,"column":31,"index":520}}},{"kind":"ObjectField","key":{"kind":"Identifier","name":"OrderId","span":{"start":{"line":20,"column":50,"index":539},"end":{"line":20,"column":50,"index":539}}},"value":{"kind":"IdentifierExpr","id":{"kind":"Identifier","name":"OrderId","span":{"start":{"line":20,"column":50,"index":539},"end":{"line":20,"column":50,"index":539}}},"span":{"start":{"line":20,"column":50,"index":539},"end":{"line":20,"column":50,"index":539}}},"span":{"start":{"line":20,"column":31,"index":520},"end":{"line":20,"column":31,"index":520}}},{"kind":"ObjectField","key":{"kind":"Identifier","name":"userId","span":{"start":{"line":20,"column":58,"index":547},"end":{"line":20,"column":58,"index":547}}},"value":{"kind":"MemberExpr","object":{"kind":"IdentifierExpr","id":{"kind":"Identifier","name":"input","span":{"start":{"line":20,"column":65,"index":554},"end":{"line":20,"column":65,"index":554}}},"span":{"start":{"line":20,"column":65,"index":554},"end":{"line":20,"column":65,"index":554}}},"property":{"kind":"Identifier","name":"userId","span":{"start":{"line":20,"column":72,"index":561},"end":{"line":20,"column":72,"index":561}}},"span":{"start":{"line":20,"column":72,"index":561},"end":{"line":20,"column":72,"index":561}}},"span":{"start":{"line":20,"column":31,"index":520},"end":{"line":20,"column":31,"index":520}}},{"kind":"ObjectField","key":{"kind":"Identifier","name":"total","span":{"start":{"line":20,"column":79,"index":568},"end":{"line":20,"column":79,"index":568}}},"value":{"kind":"MemberExpr","object":{"kind":"IdentifierExpr","id":{"kind":"Identifier","name":"input","span":{"start":{"line":20,"column":86,"index":575},"end":{"line":20,"column":86,"index":575}}},"span":{"start":{"line":20,"column":86,"index":575},"end":{"line":20,"column":86,"index":575}}},"property":{"kind":"Identifier","name":"total","span":{"start":{"line":20,"column":93,"index":582},"end":{"line":20,"column":93,"index":582}}},"span":{"start":{"line":20,"column":93,"index":582},"end":{"line":20,"column":93,"index":582}}},"span":{"start":{"line":20,"column":31,"index":520},"end":{"line":20,"column":31,"index":520}}}],"span":{"start":{"line":20,"column":31,"index":520},"end":{"line":20,"column":31,"index":520}}}],"span":{"start":{"line":20,"column":95,"index":584},"end":{"line":20,"column":95,"index":584}}},"span":{"start":{"line":20,"column":9,"index":498},"end":{"line":20,"column":9,"index":498}}}],"span":{"start":{"line":18,"column":104,"index":451},"end":{"line":18,"column":104,"index":451}}},"span":{"start":{"line":18,"column":7,"index":354},"end":{"line":18,"column":7,"index":354}}}],"span":{"start":{"line":1,"column":1,"index":0},"end":{"line":22,"column":1,"index":588}}}}
{"source_il":"intent \"Payment service\" tags [\"payments\"]\r\n\r\nuses {\r\n  http: Http { baseUrl: \"https://api.example.com\", timeoutMs: 3000 },\r\n}\r\n\r\ntypes {\r\n  type CardNumber = String brand \"CardNumber\" where matches(\"^\\\\d{16}$\");\r\n  type PaymentId = Uuid;\r\n  type Payment =\r\n    | Card { id: PaymentId, card: CardNumber }\r\n    | Cash { id: PaymentId, amount: Float where _ >= 0 };\r\n  type PaymentError = { code: Int, message: String };\r\n}\r\n\r\neffect processPayment(p: Payment): Result<Bool, PaymentError> uses http {\n  return http.post(\"/payments\", p);\n}\n","transpiled_py":"# Generated by IntentLang\n# DO NOT EDIT MANUALLY\n\nfrom __main__ import Http, Result\n\n# TODO: Implementar un sistema de ordenación de tipos basado en dependencias en lugar de este enfoque simple de dos pasadas.\n@dataclass\nclass Card:\n    id: PaymentId\n    card: CardNumber\n\n@dataclass\nclass Cash:\n    id: PaymentId\n    amount: float\n\n@dataclass\nclass PaymentError:\n    code: int\n    message: str\n\nCardNumber = NewType('CardNumber', str)\nPaymentId = str\nPayment = Union[Card, Cash]\n\nasync def processPayment(deps, p: Payment) -> Result[bool, PaymentError]:\n    # TODO: Implementar la cláusula 'ensures' para efectos.\n    # Stmt type 'ExprStmt' not implemented","ast":null}
{"source_il":"intent \"User service\" tags [\"api\",\"users\"]\r\n\r\nuses {\r\n  http: Http { baseUrl: \"https://api.example.com\", timeoutMs: 2500 },\r\n  clock: Clock {},\r\n}\r\n\r\ntypes {\r\n  type Email = String brand \"Email\" where matches(\"^[^@]+@[^@]+\\\\.[^@]+$\");\r\n  type UserId = Uuid;\r\n  type User = {\r\n    id: UserId,\r\n    name: String where _.length >= 2,\r\n    email: Email,\r\n    createdAt: DateTime,\r\n  };\r\n  type ApiError = { code: Int, message: String };\r\n}\r\n\r\nfunc toEmail(s: String): Result<Email, String> {\n  if matches(\"^[^@]+@[^@]+\\\\.[^@]+$\", s) {\n    return Ok(s as Email);\n  } else {\n    return Err(\"Invalid email\");\n  }\n}\n\neffect createUser(input: { name: String, email: Email }): Result<User, ApiError> uses http, clock {\n  return http.post(\"/users\", {\n    name: input.name,\n    email: input.email,\n    createdAt: clock.now(),\n  });\n}\n","transpiled_py":"# Generated by IntentLang\n# DO NOT EDIT MANUALLY\n\nfrom __main__ import Http, Clock, Result\n\n# TODO: Implementar un sistema de ordenación de tipos basado en dependencias en lugar de este enfoque simple de dos pasadas.\n@dataclass\nclass User:\n    id: UserId\n    name: str\n    email: Email\n    createdAt: datetime\n\n@dataclass\nclass ApiError:\n    code: int\n    message: str\n\nEmail = NewType('Email', str)\nUserId = str\n\ndef toEmail(s: str) -> Result[Email, str]:\n    # TODO: Implementar la cláusula 'ensures'. Podría requerir decorar la función o inyectar aserciones antes de cada 'return'.\n    # Stmt type 'ExprStmt' not implemented\n\nasync def createUser(deps, input: object) -> Result[User, ApiError]:\n    assert len(input.name) >= 2, \"Precondition failed\"\n    # TODO: Implementar la cláusula 'ensures' para efectos.\n    # Stmt type 'ExprStmt' not implemented","ast":null}
